# Load the data
Quantil_final_final <- read.csv("C:/Users/massth/Desktop/SMC/Figure_final/Data_figure_2_&_S2.6.csv",header = T)
# Transform constrained variable into factor
Quantil_final_final$Age <- factor(Quantil_final_final$Age, levels = c("5", "10"))
Quantil_final_final$Coverage_reduction <- factor(Quantil_final_final$Coverage_reduction, levels = c("0", "0.1"))
Quantil_final_final$Seasonality <- factor(Quantil_final_final$Seasonality, levels = c("sesonality2", "sesonality3"))
Quantil_final_final$Number_round <- factor(Quantil_final_final$Number_round, levels = c("4", "4.5", "5.4"))
Quantil_final_final$Factor <- factor(Quantil_final_final$Factor, levels = c("eir", "Coverage", "Access"))
# Create labels for each constrain factor
F.labs <- c("Access to treatment\n (%)", "SMC Coverage\n (%)", "EIR\n(inoculations per person per year)")
names(F.labs) <- c("Access", "Coverage", "eir")
# Define the break for the y axis
break_y <- c(1, 10, 20, 30, 39)
Label_yy <- c("Min", "", "", "", "Max")
# Select all settings with low seasonality
Quantil_final_2 <- Quantil_final_final[Quantil_final_final$Seasonality == "sesonality2",]
Quantil_final_2 <- Quantil_final_2[Quantil_final_2$Number_round==4 & Quantil_final_2$Coverage_reduction==0 & Quantil_final_2$Age==5,]
Quantil_final_2$Range[Quantil_final_2$Factor=="eir"] <- seq(5,500, length=40)
Quantil_final_2$Range[Quantil_final_2$Factor=="Access"] <- seq(10,80, length=40)
Quantil_final_2$Range[Quantil_final_2$Factor=="Coverage"] <- seq(70,100, length=40)
# Plot
constant <- 2.5
P1 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="eir",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "Rate of spread of the quintuple mutant", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
# Load package
library("rlang")
library("ggh4x")
library("ggplot2")
library("plyr")
# Load the data
Quantil_final_final <- read.csv("C:/Users/massth/Desktop/SMC/Figure_final/Data_figure_2_&_S2.6.csv",header = T)
# Transform constrained variable into factor
Quantil_final_final$Age <- factor(Quantil_final_final$Age, levels = c("5", "10"))
Quantil_final_final$Coverage_reduction <- factor(Quantil_final_final$Coverage_reduction, levels = c("0", "0.1"))
Quantil_final_final$Seasonality <- factor(Quantil_final_final$Seasonality, levels = c("sesonality2", "sesonality3"))
Quantil_final_final$Number_round <- factor(Quantil_final_final$Number_round, levels = c("4", "4.5", "5.4"))
Quantil_final_final$Factor <- factor(Quantil_final_final$Factor, levels = c("eir", "Coverage", "Access"))
# Create labels for each constrain factor
F.labs <- c("Access to treatment\n (%)", "SMC Coverage\n (%)", "EIR\n(inoculations per person per year)")
names(F.labs) <- c("Access", "Coverage", "eir")
# Define the break for the y axis
break_y <- c(1, 10, 20, 30, 39)
Label_yy <- c("Min", "", "", "", "Max")
# Select all settings with low seasonality
Quantil_final_2 <- Quantil_final_final[Quantil_final_final$Seasonality == "sesonality2",]
Quantil_final_2 <- Quantil_final_2[Quantil_final_2$Number_round==4 & Quantil_final_2$Coverage_reduction==0 & Quantil_final_2$Age==5,]
Quantil_final_2$Range[Quantil_final_2$Factor=="eir"] <- seq(5,500, length=40)
Quantil_final_2$Range[Quantil_final_2$Factor=="Access"] <- seq(10,80, length=40)
Quantil_final_2$Range[Quantil_final_2$Factor=="Coverage"] <- seq(70,100, length=40)
# Plot
constant <- 2.5
P1 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="eir",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "Rate of spread of the quintuple mutant", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
P2 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="Coverage",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
P3 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="Access",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
PLOT_S1 <- plot_grid(P1, P2, P3 ,ncol= 3, nrow = 1, scale = 1, labels = c("A", "B", "C"), label_size = 18 / constant, label_fontface = 2)
PLOT_S1
PLOT_S1 <- plot_grid(P1, P2, P3 ,ncol= 3, nrow = 1, scale = 1, labels = c("A", "B", "C"), label_size = 18 / constant, label_fontface = 2)
library("cowplot")
PLOT_S1 <- plot_grid(P1, P2, P3 ,ncol= 3, nrow = 1, scale = 1, labels = c("A", "B", "C"), label_size = 18 / constant, label_fontface = 2)
PLOT_S1
PLOT_S1
P1 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="eir",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "Rate of spread", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
P1 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="eir",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "Rate of spread", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
P2 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="Coverage",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
P3 <- ggplot(data = Quantil_final_2[Quantil_final_2$Factor=="Access",]) +
geom_line(aes(x = Range, y = Selection_coefficient, color = Factor), size = 3 / constant, alpha = 0.75) +
geom_ribbon(aes(x = Range, ymin = Lower_quartile, ymax = Upper_quartile, fill = Factor), alpha = 0.1) +
facet_wrap(~Factor, scales = "free_x", nrow = 1, strip.position = "bottom" ,labeller = labeller(Factor = F.labs))  +
theme_bw() +
ggtitle("") +
scale_y_continuous(name = "", lim = c(0, 0.03)) +
scale_x_continuous(name = "") +
theme(axis.text.x = element_text(size = 16 / constant),
axis.text.y = element_text(size = 16 / constant),
axis.title.x = element_text(size = 18 / constant, face = "bold", hjust = -0.2),
axis.title.y = element_text(size = 18 / constant, face = "bold"),
plot.title = element_text(size = 18 / constant, hjust = 0.5, face = "bold")) +
theme(legend.position = "none") +
scale_color_manual(name = "Factors:", values = c("#2C85B2", "#E5B17E", "#BFB2FF"), labels = c("SMC coverage", "EIR", "Treatment access", "half_life_long"), breaks = c("Coverage", "eir", "Access", "half_life_long")) +
ggtitle(label = "") +
theme(strip.text.x = element_text(size = 18 / constant, color = "black", face = "bold"),
strip.text.y = element_text(size = 18 / constant, color = "black", face = "bold")) +
theme(plot.margin = unit(c(0.1,  0.1, 0.1, 0.1), "cm"))+
theme(strip.background = element_blank(),  strip.placement = "outside")
PLOT_S1 <- plot_grid(P1, P2, P3 ,ncol= 3, nrow = 1, scale = 1, labels = c("A", "B", "C"), label_size = 18 / constant, label_fontface = 2)
PLOT_S1
library(hmer)
install.packages("hmer")
library(hmer)
library(deSolve)
library(ggplot2)
library(reshape2)
install.packages("reshape2")
install.packages("purrr")
library(purrr)
library(tidyverse)
install.packages("tidyverse")
library(lhs)
library(hmer)
library(deSolve)
library(ggplot2)
library(reshape2)
library(deSolve)
library(ggplot2)
library(purrr)
library(tidyverse)
library(tidyverse)
library(deSolve)
library(ggplot2)
library(purrr)
library(lhs)
install.packages("reshape2")
library(reshape2)
install.packages("lifecycle")
install.packages("lifecycle")
library(reshape2)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
library(hmer)
library(reshape2)
library(rlang)
library(reshape2)
library(hmer)
library(tidyverse)
remove.packages(rlang)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
library(rlang)
library(tidyverse)
install.packages("rlang")
install.packages("rlang")
library(tidyverse)
library(rlang)
library(tidyverse)
install.packages("rlang")
install.packages(Rtools)
install.packages("Rtools")
library(rlang)
library(tidyverse)
install.packages("rlang")
install.packages("rlang")
library(rlang)
library(tidyverse)
if(!require(installr)) {
install.packages("installr");
require(installr)
}
updateR()
require(installr)
install.packages("installr")
library(ggplot2)
library(rlang)
install.packages(c("cli", "crayon", "digest", "farver", "ggh4x", "ggplot2", "gtable", "isoband", "pillar", "plyr", "rlang", "scales", "stringi", "tibble", "vctrs", "viridisLite"))
install.packages(c("cli", "crayon", "digest", "farver", "ggh4x", "ggplot2", "gtable", "isoband", "pillar", "plyr", "rlang", "scales", "stringi", "tibble", "vctrs", "viridisLite"))
install.packages(c("cli", "crayon", "digest", "farver", "ggh4x", "ggplot2", "gtable", "isoband", "pillar", "plyr", "rlang", "scales", "stringi", "tibble", "vctrs", "viridisLite"))
library(hmer)
library(reshape2)
library(rlang)
library(tidyverse)
library(deSolve)
library(ggplot2)
library(purrr)
library(lhs)
library(ggplot2)
library(hmer)
library(deSolve)
library(ggplot2)
library(reshape2)
library(purrr)
library(tidyverse)
library(lhs)
remove.packages(rlang)
